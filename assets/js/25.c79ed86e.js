(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{239:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("ol",[n("li",[n("p",[t._v("增加 测试环境")]),t._v(" "),n("ul",[n("li",[t._v("开发环境-> mock")]),t._v(" "),n("li",[t._v("测试环境 -> proxy")]),t._v(" "),n("li",[t._v("生成环境 -> baseUrl")])])]),t._v(" "),n("li",[n("p",[t._v("更换loading")])]),t._v(" "),n("li",[n("p",[t._v("AOP 面向切面编程，统一配置超时请求，")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ax "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("create")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  baseURL"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" baseUrl"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  timeout"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("10000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  withCredentials"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// 允许携带cookie")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("use")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'development'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// switch (response.data.code) {")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//     case 0:")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         break;")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//     case 1:")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         vue.$x.toast('失败')")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         break;")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//     case 4:")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         vue.$x.toast('请求参数异常')")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         break;")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//     default:")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//         break;")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("includes")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'timeout'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("   "),n("span",{attrs:{class:"token comment"}},[t._v("// 判断请求异常信息中是否含有超时timeout字符串")]),t._v("\n      console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"错误回调"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      vue"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loading"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("hide")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      vue"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("toast")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'请求超时请稍后再试'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("reject")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("          "),n("span",{attrs:{class:"token comment"}},[t._v("// reject这个错误信息")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("vw布局更新\npostcss-px-to-viewport更新为1.1")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("    \"postcss-px-to-viewport\": {\n        viewportWidth: 750, //视窗的宽度，对应的是我们设计稿的宽度，一般是750\n        viewportHeight: 1334, // 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置\n        unitPrecision: 3, // 指定`px`转换为视窗单位值的小数位数（很多时候无法整除）\n        viewportUnit: 'vw', // 指定需要转换成的视窗单位，建议使用vw\n        selectorBlackList: ['.ignore', '.hairlines'], // 指定不转换为视窗单位的类，可以自定义，可以无限添加,建议定义一至两个通用的类名\n        minPixelValue: 1, // 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值\n        mediaQuery: false, // 允许在媒体查询中转换`px`\n        exclude:/node_modules/i,\n        // selectorBlackList: ['delivery_alert_box']//黑名单\n    },\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[n("p",[t._v("keep-alive缓存多个组件\n项目需求为:滑动郑爽等5个任务组件，请求对应的资源分别请求四个接口，3个并行一个串行，并且相对应的卡片种类下，还会有二级类，二级类还可以下拉加载")]),t._v(" "),n("p",[t._v("利用keep_alive缓存多个组件,可以只在第一个切换组件的时候去请求，之后切换时缓存相对应的组件，当再次切换到改组件时，激活，这样可以提升用户体验，缓解服务器压力。")]),t._v(" "),n("p",[t._v("当然这样做的前提是，对应的数据并不是试试更新的。")])])]),t._v(" "),n("img",{attrs:{src:"/img/qingchundou.png",width:"80%"}}),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("        \x3c!-- 缓存对应状态 --\x3e\n        <keep-alive v-if='isAPP'>\n            \x3c!-- 类微信聊天组件 --\x3e\n            <chat-box :key='realIndex' :source='audioCurrent' :avator='avatorCurrent' :index='realIndex' :roleId='roleId'></chat-box>\n        </keep-alive>\n        <keep-alive>\n            <famous-company :key='roleId' :roleId='roleId' />\n        </keep-alive>\n        <keep-alive>\n            <job-box :roleId='roleId' :key='roleId' />\n        </keep-alive>\n        <guide></guide>\n")])])]),n("pre",[n("code",[t._v("**注意** 因为每个组件都会有onscroll事件，scroll应该在activated是注册，不要再mounted的时候注册 因为重新激活组件的时候并不会重新执行mounted。\n")])]),t._v(" "),n("p",[t._v("jobBox")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("    mounted() {\n        // keep-alive不会执行\n        console.log('切换组件')\n        this.init()\n    },\n    activated() {\n        console.log('激活', this.roleId)\n        /**\n         * scroll应该在activated是注册，不要再mounted的时候注册 因为重新激活组件的时候并不会重新执行mounted\n         */\n        this.scroll()\n\n    },\n    deactivated() {\n        console.log('停用', this.roleId)\n    },\n    methods: {\n        scroll() {\n            window.onscroll = () => {\n                if (\n                    utils.getScrollTop() + utils.getClientHeight() +100 >= utils.getScrollHeight() &&\n                    this.loadingMore\n                ) {\n                    // 只展示五页\n                    this.pageIndex <= 4 && this.pageIndex++;\n                    console.log('滚动' + this.pageIndex)\n                }\n            };\n        },\n        }\n")])])]),n("ol",{attrs:{start:"5"}},[n("li",[n("h2",{attrs:{id:"eventbus总线"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#eventbus总线","aria-hidden":"true"}},[t._v("#")]),t._v(" eventBus总线")])])])])}],!1,null,null,null);e.options.__file="青春斗.md";s.default=e.exports}}]);